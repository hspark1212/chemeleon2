# @package _global_
# GRPO for DNG on MP-20
defaults:
  - override /data: mp-20
  - override /rl_module: rl_module
  - override /callbacks: default
  - override /logger: wandb
  - override /scheduler: constant
  - override /paths: default
  - override /hydra: default

data:
  batch_size: 5

rl_module:
  ldm_ckpt_path: ${hub:mp_20_ldm}
  vae_ckpt_path: ${hub:mp_20_vae}

  rl_configs:
    num_group_samples: 64
    group_reward_norm: true

  reward_fn:
    _target_: src.rl_module.reward.ReinforceReward
    normalize_fn: std
    eps: 1e-4
    reference_dataset: mp-20
    components:
      - _target_: src.rl_module.components.CreativityReward
        weight: 1.0
        normalize_fn: null
      - _target_: src.rl_module.components.EnergyReward
        weight: 1.0
        normalize_fn: norm
      - _target_: src.rl_module.components.StructureDiversityReward
        weight: 0.1
        normalize_fn: norm
      - _target_: src.rl_module.components.CompositionDiversityReward
        weight: 1.0
        normalize_fn: norm

logger:
  wandb:
    name: rl_dng_grpo
